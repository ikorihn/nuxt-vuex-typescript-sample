# Nuxt.js + TypeScript + Vuex + Jest の環境構築

## セットアップ

```bash

$ node -v
v13.2.0
$ yarn -v
1.19.2

$ yarn create nuxt-app nuxt-typescript
yarn create v1.19.2
[1/4] 🔍 Resolving packages...
[2/4] 🚚 Fetching packages...
[3/4] 🔗 Linking dependencies...
[4/4] 🔨 Building fresh packages...

success Installed "create-nuxt-app@2.12.0" with binaries: - create-nuxt-app

create-nuxt-app v2.12.0
✨ Generating Nuxt.js project in nuxt-typescript
? Project name nuxt-typescript
? Project description My geometric Nuxt.js project
? Author name
? Choose the package manager Yarn
? Choose UI framework None
? Choose custom server framework None (Recommended)
? Choose Nuxt.js modules Axios
? Choose linting tools ESLint, Prettier
? Choose test framework Jest
? Choose rendering mode Single Page App
? Choose development tools
...
🎉 Successfully created project nuxt-typescript

To get started:

    cd nuxt-typescript
    yarn dev

To build & start for production:

    cd nuxt-typescript
    yarn build
    yarn start

To test:

    cd nuxt-typescript
    yarn test

✨ Done in 110.26s.

$ cd nuxt-typescript
$ yarn dev
=> http://localhost:3000/ で画面が開ける
```

## TypeScript の導入

https://nuxtjs.org/guide/typescript/
https://typescript.nuxtjs.org/

### Runtime のインストール

Rumtime は、nuxt.config.ts、modules および serverMiddlewares といった Webpack でコンパイルされていないファイルのために必要です。

```bash
$ yarn add @nuxt/typescript-runtime
# nuxt.config.js ファイルをts に変換する
$ mv nuxt.config.js nuxt.config.ts
```

#### Configuration に型付け

```diff
--- a/nuxt.config.js
+++ b/nuxt.config.ts
@@ -1,4 +1,6 @@
-export default {
+import { Configuration } from '@nuxt/types'
+
+const config: Configuration = {
   mode: 'spa',
   /*
    ** Headers of the page
@@ -57,3 +59,5 @@ export default {
     extend(config, ctx) {}
   }
 }
+
+export default config
```

package.json

```diff
   "scripts": {
-    "dev": "nuxt",
-    "build": "nuxt build",
-    "start": "nuxt start",
-    "generate": "nuxt generate",
+    "dev": "nuxt-ts",
+    "build": "nuxt-ts build",
+    "start": "nuxt-ts start",
+    "generate": "nuxt-ts generate",
     "lint": "eslint --ext .js,.vue --ignore-path .gitignore .",
     "test": "jest"
   },
```

### TypeScript モジュールのインストール

```bash
$ yarn add --dev @nuxt/typescript-build
```

#### 設定

```json
// nuxt.config.ts
const config: Configuration = {
  buildModules: ['@nuxt/typescript-build']
}
```

```json
// tsconfig.json
{
  "compilerOptions": {
    "target": "esnext",
    "module": "esnext",
    "moduleResolution": "node",
    "lib": ["esnext", "esnext.asynciterable", "dom"],
    "esModuleInterop": true,
    "allowJs": true,
    "sourceMap": true,
    "strict": true,
    "noEmit": true,
    "baseUrl": ".",
    "paths": {
      "~/*": ["./*"],
      "@/*": ["./*"]
    },
    "types": ["@types/node", "@nuxt/types"]
  },
  "exclude": ["node_modules"]
}
```

### Lint

```bash
$ yarn add -D @nuxtjs/eslint-config-typescript
```

```json
// .eslintrc.js
module.exports = {
  "extends": ["@nuxtjs/eslint-config-typescript"]
}
```

```json
// package.json
"lint": "eslint --ext .js,.ts,.vue --ignore-path .gitignore .",
```